<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<title>Calculadora gen√©tica ‚Äì Gecko leopardo</title>

<style>
body{
  background:#0f0f0f;
  color:#eaeaea;
  font-family:system-ui, Arial, sans-serif;
  padding:20px;
}
h1{ color:#4cff4c; }
label{ display:block; margin-top:15px }
select{
  width:100%;
  padding:10px;
  margin-top:5px;
  border-radius:8px;
  border:none;
  background:#1e1e1e;
  color:#fff;
  font-size:16px;
}
.box{
  width:100%;
  padding:12px;
  margin-top:10px;
  border-radius:8px;
  background:#1c1c1c;
  white-space:pre-line;
}
</style>
</head>

<body>

<h1>ü¶é Calculadora gen√©tica ‚Äì Gecko leopardo</h1>

<label>Macho</label>
<select id="macho"></select>

<label>Hembra</label>
<select id="hembra"></select>

<div class="box" id="resultado"><b>Resultado gen√©tico:</b></div>
<div class="box" id="porcentajes"><b>Porcentajes:</b></div>
<div class="box" id="nombres"><b>Nombres completos:</b></div>
<div class="box" id="avisos"><b>Avisos:</b></div>

<script>
const SHEET_ID = "10_JEvHlKBpfyHCSWSvdWotYeyuvriE-Qu-Om0ENwRnY";
const URL = `https://docs.google.com/spreadsheets/d/${SHEET_ID}/gviz/tq?tqx=out:json`;

let fases = [];

/* ======================
   CARGA DE FASES
====================== */
fetch(URL)
  .then(r => r.text())
  .then(t => {
    const json = JSON.parse(t.substr(47).slice(0,-2));
    json.table.rows.forEach(r=>{
      if(!r.c[1] || !r.c[2]) return;
      fases.push({
        fase: r.c[1].v,
        tipo: r.c[2].v.toLowerCase()
      });
    });
    cargarSelects();
  });

function cargarSelects(){
  const macho = document.getElementById("macho");
  const hembra = document.getElementById("hembra");
  fases.forEach(f=>{
    macho.add(new Option(f.fase,f.fase));
    hembra.add(new Option(f.fase,f.fase));
  });
  macho.onchange = hembra.onchange = calcular;
  calcular();
}

function tipoDe(fase){
  return fases.find(f=>f.fase===fase)?.tipo;
}

/* ======================
   C√ÅLCULO PRINCIPAL
====================== */
function calcular(){
  const m = document.getElementById("macho").value;
  const h = document.getElementById("hembra").value;
  const tm = tipoDe(m);
  const th = tipoDe(h);

  let resultado = "";
  let porcentajes = "";
  let nombres = [];
  let avisos = [];

  /* ===== RECESIVO ===== */
  if(tm==="recesivo" && th==="recesivo"){
    resultado = "Cruce recesivo √ó recesivo";
    if(m===h){
      porcentajes = "25 % visual ¬∑ 50 % heterocigoto ¬∑ 25 % normal";
      nombres = ["Normal","Het "+m,m];
    }else{
      porcentajes = "0 % visual ¬∑ 100 % heterocigotos";
      nombres = ["Normal","Het "+m,"Het "+h];
      avisos.push("‚ö†Ô∏è Recesivos distintos: no habr√° visuales.");
    }
  }

  /* ===== CODOMINANTE ===== */
  else if(tm==="codominante" && th==="codominante"){
    resultado = "Cruce codominante √ó codominante";
    if(m===h){
      porcentajes = "25 % super ¬∑ 50 % intermedio ¬∑ 25 % normal";
      nombres = ["Normal",m,"Super "+m];
    }else{
      porcentajes = "25 % combinaci√≥n ¬∑ 50 % intermedios ¬∑ 25 % normales";
      nombres = [m,h,m+" "+h];
    }
  }

  /* ===== DOMINANTE ===== */
  else if(tm==="dominante" || th==="dominante"){
    const d = tm==="dominante" ? m : h;
    resultado = "Cruce con gen dominante";
    porcentajes = "‚âà50 % expresar√°n el rasgo dominante";
    nombres = ["Normal",d];
  }

  /* ===== POLIG√âNICO ===== */
  else if(tm==="polig√©nico" || th==="polig√©nico"){
    resultado = "Cruce polig√©nico";
    porcentajes = "Sin porcentajes fijos (expresi√≥n variable)";
    nombres = ["Normal",m+" "+h];
    avisos.push("‚ÑπÔ∏è Rasgo polig√©nico: resultado variable.");
  }

  /* ===== MIXTO ===== */
  else{
    resultado = "Cruce mixto";
    porcentajes = "Expresi√≥n variable con posibles portadores";
    nombres = ["Normal",m+" "+h];
  }

  /* ===== AVISOS INTELIGENTES ===== */
  if(
    (m.includes("Tremper") && h.includes("Bell")) ||
    (m.includes("Bell") && h.includes("Tremper"))
  ){
    avisos.push("‚ùå Tremper y Bell NO deben cruzarse.");
  }

  if(m.includes("Enigma") || h.includes("Enigma")){
    avisos.push("‚ö†Ô∏è Enigma: posible riesgo neurol√≥gico.");
  }

  if(m===h){
    avisos.push("‚ÑπÔ∏è Cruce lineal: vigilar consanguinidad.");
  }

  /* ===== SALIDA ===== */
  document.getElementById("resultado").innerHTML =
    "<b>Resultado gen√©tico:</b> " + resultado;

  document.getElementById("porcentajes").innerHTML =
    "<b>Porcentajes:</b> " + porcentajes;

  document.getElementById("nombres").innerHTML =
    "<b>Nombres completos:</b><br>‚Ä¢ " + nombres.join("<br>‚Ä¢ ");

  document.getElementById("avisos").innerHTML =
    "<b>Avisos:</b><br>‚Ä¢ " + (avisos.length ? avisos.join("<br>‚Ä¢ ") : "Ninguno");
}
</script>

</body>
</html>
