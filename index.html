<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<title>Calculadora gen√©tica ‚Äì Gecko leopardo</title>
<style>
body {
  font-family: Arial, sans-serif;
  background:#0f0f0f;
  color:#eee;
  padding:20px;
}
h1 { color:#6aff9c }
label { display:block; margin-top:15px }
select {
  width:100%;
  padding:10px;
  font-size:16px;
  margin-top:5px;
}
.box {
  background:#1c1c1c;
  padding:15px;
  border-radius:8px;
  margin-top:15px;
}
</style>
</head>

<body>

<h1>ü¶é Calculadora gen√©tica ‚Äì Gecko leopardo</h1>

<label>Macho</label>
<select id="macho"></select>

<label>Hembra</label>
<select id="hembra"></select>

<div class="box" id="resultado">Resultado aparecer√° aqu√≠</div>
<div class="box" id="fases">Fases posibles aparecer√°n aqu√≠</div>
<div class="box" id="avisos">Avisos aparecer√°n aqu√≠</div>

<script>
const SHEET_ID = "10_JEvHlKBpfyHCSWSvdWotYeyuvriE-Qu-Om0ENwRnY";
const SHEET_NAME = "Hoja 1";

// cargar fases desde Sheets
function cargarFases(){
  const url = `https://docs.google.com/spreadsheets/d/${SHEET_ID}/gviz/tq?tqx=out:json&sheet=${encodeURIComponent(SHEET_NAME)}`;

  fetch(url)
    .then(res => res.text())
    .then(text => {
      const json = JSON.parse(text.substring(47).slice(0, -2));
      const rows = json.table.rows;

      const fases = new Set();

      rows.forEach(r => {
        if (r.c[1] && r.c[1].v) fases.add(r.c[1].v);
      });

      const macho = document.getElementById("macho");
      const hembra = document.getElementById("hembra");

      fases.forEach(f => {
        macho.add(new Option(f, f));
        hembra.add(new Option(f, f));
      });
    });
}

// leer resultado del simulador
function actualizar(){
  const url = `https://docs.google.com/spreadsheets/d/${SHEET_ID}/gviz/tq?tqx=out:json&sheet=simulador`;

  fetch(url)
    .then(res => res.text())
    .then(text => {
      const json = JSON.parse(text.substring(47).slice(0, -2));
      const rows = json.table.rows;

      document.getElementById("resultado").innerText = rows[5].c[0].v;
      document.getElementById("fases").innerText = rows[7].c[0].v;
      document.getElementById("avisos").innerText = rows[9].c[0].v;
    });
}

document.addEventListener("DOMContentLoaded", () => {
  cargarFases();
  document.querySelectorAll("select").forEach(s =>
    s.addEventListener("change", actualizar)
  );
});
</script>

</body>
</html>
