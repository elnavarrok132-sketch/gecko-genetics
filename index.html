<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<title>Calculadora genÃ©tica â€“ Gecko leopardo</title>

<style>
body{
  font-family: Arial, sans-serif;
  background:#0f0f0f;
  color:#eee;
  padding:20px;
}
h1{ color:#6aff9c }
label{ display:block; margin-top:15px }
select{
  width:100%;
  padding:10px;
  font-size:16px;
  margin-top:5px;
}
.box{
  background:#1c1c1c;
  padding:15px;
  border-radius:8px;
  margin-top:15px;
  white-space:pre-line;
}
</style>
</head>

<body>

<h1>ðŸ¦Ž Calculadora genÃ©tica â€“ Gecko leopardo</h1>

<label>Macho</label>
<select id="macho"></select>

<label>Hembra</label>
<select id="hembra"></select>

<div class="box" id="resultado">â€”</div>
<div class="box" id="fases">â€”</div>
<div class="box" id="avisos">â€”</div>

<script>
const SHEET_ID = "10_JEvHlKBpfyHCSWSvdWotYeyuvriE-Qu-Om0ENwRnY";

// Cargar fases (Hoja 1, columna B)
function cargarFases(){
  const url = `https://docs.google.com/spreadsheets/d/${SHEET_ID}/gviz/tq?tqx=out:json&sheet=Hoja 1`;

  fetch(url)
    .then(r=>r.text())
    .then(t=>{
      const json = JSON.parse(t.substring(47).slice(0,-2));
      const rows = json.table.rows;
      const set = new Set();

      rows.forEach(r=>{
        if(r.c[1] && r.c[1].v) set.add(r.c[1].v);
      });

      const macho = document.getElementById("macho");
      const hembra = document.getElementById("hembra");

      set.forEach(f=>{
        macho.add(new Option(f,f));
        hembra.add(new Option(f,f));
      });
    });
}

// Leer simulador
function actualizar(){
  const url = `https://docs.google.com/spreadsheets/d/${SHEET_ID}/gviz/tq?tqx=out:json&sheet=simulador`;

  fetch(url)
    .then(r=>r.text())
    .then(t=>{
      const json = JSON.parse(t.substring(47).slice(0,-2));
      const rows = json.table.rows;

      let resultado="â€”", fases="â€”", avisos="â€”";

      rows.forEach(r=>{
        if(!r.c[0]) return;
        const k = r.c[0].v.toLowerCase();

        if(k==="resultado") resultado = r.c[1]?.v || "â€”";
        if(k==="fases") fases = r.c[1]?.v || "â€”";
        if(k==="avisos") avisos = r.c[1]?.v || "â€”";
      });

      document.getElementById("resultado").innerText = resultado;
      document.getElementById("fases").innerText = fases;
      document.getElementById("avisos").innerText = avisos;
    });
}

document.addEventListener("DOMContentLoaded", ()=>{
  cargarFases();
  document.querySelectorAll("select").forEach(s=>{
    s.addEventListener("change", actualizar);
  });
});
</script>

</body>
</html>
