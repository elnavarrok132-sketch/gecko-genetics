<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<title>Calculadora gen√©tica ‚Äì Gecko leopardo</title>
<style>
body {
  background:#0f0f0f;
  color:#eaeaea;
  font-family:system-ui;
  padding:20px;
}
h1 { color:#4cff4c; }
select, .box {
  width:100%;
  padding:10px;
  margin:8px 0;
  border-radius:8px;
  border:none;
  background:#1e1e1e;
  color:#fff;
}
.box { min-height:50px; }
</style>
</head>

<body>

<h1>ü¶é Calculadora gen√©tica ‚Äì Gecko leopardo</h1>

<label>Macho</label>
<select id="macho"></select>

<label>Hembra</label>
<select id="hembra"></select>

<div class="box" id="resultado"><b>Resultado gen√©tico:</b></div>
<div class="box" id="fases"><b>Fases posibles:</b></div>
<div class="box" id="avisos"><b>Avisos:</b></div>

<script>
const SHEET_ID = "10_JEvHlKBpfyHCSWSvdWotYeyuvriE-Qu-Om0ENwRnY";
const URL = `https://docs.google.com/spreadsheets/d/${SHEET_ID}/gviz/tq?tqx=out:json`;

let fases = [];

fetch(URL)
  .then(r => r.text())
  .then(t => {
    const json = JSON.parse(t.substr(47).slice(0,-2));
    json.table.rows.forEach(r=>{
      fases.push({
        fase:r.c[1]?.v,
        tipo:r.c[2]?.v.toLowerCase()
      });
    });
    cargarSelects();
  });

function cargarSelects(){
  const macho = document.getElementById("macho");
  const hembra = document.getElementById("hembra");
  fases.forEach(f=>{
    macho.innerHTML += `<option>${f.fase}</option>`;
    hembra.innerHTML += `<option>${f.fase}</option>`;
  });
  macho.onchange = hembra.onchange = calcular;
  calcular();
}

function tipoDe(fase){
  return fases.find(f=>f.fase===fase)?.tipo;
}

function calcular(){
  const m = document.getElementById("macho").value;
  const h = document.getElementById("hembra").value;
  const tm = tipoDe(m);
  const th = tipoDe(h);

  let res = "Combinaci√≥n no contemplada.";
  let fasesTxt = "";
  let aviso = "";

  if(tm==="recesivo" && th==="recesivo"){
    res = "Cruce recesivo x recesivo";
    fasesTxt = "25 % visual ¬∑ 50 % het ¬∑ 25 % normal";
    if(m!==h) aviso = "‚ö†Ô∏è Recesivos distintos: NO habr√° visuales.";
  }
  else if(tm==="codominante" || th==="codominante"){
    res = "Cruce codominante";
    fasesTxt = "25 % super ¬∑ 50 % intermedio ¬∑ 25 % normal";
  }
  else if(tm==="dominante" || th==="dominante"){
    res = "Cruce dominante";
    fasesTxt = "~50 % expresar√°n el rasgo";
  }
  else if(tm==="polig√©nico" && th==="polig√©nico"){
    res = "Cruce polig√©nico";
    fasesTxt = "Variabilidad alta (sin porcentajes fijos)";
  }
  else{
    res = "Cruce mixto";
    fasesTxt = "Posibles portadores + expresi√≥n variable";
  }

  if((m.includes("Tremper") && h.includes("Bell")) || (m.includes("Bell") && h.includes("Tremper"))){
    aviso = "‚ùå Tremper y Bell NO deben cruzarse";
  }

  document.getElementById("resultado").innerHTML = "<b>Resultado gen√©tico:</b> " + res;
  document.getElementById("fases").innerHTML = "<b>Fases posibles:</b> " + fasesTxt;
  document.getElementById("avisos").innerHTML = "<b>Avisos:</b> " + (aviso || "Ninguno");
}
</script>

</body>
</html>
